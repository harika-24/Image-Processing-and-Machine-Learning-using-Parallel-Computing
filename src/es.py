import requests
from elasticsearch import Elasticsearch
import json

es = Elasticsearch()
# print(es.info())
res = es.search(index="face-bv", body={
  "query": {
    "function_score": {
      "boost_mode": "replace",
      "script_score": {
        "script": {
          "inline": "binary_vector_score",
          "lang": "knn",
          "params": {
            "cosine": False,
            "field": "embedding_vector",
            "vector": [
               -0.129657119512558,0.065905846655369,0.089806623756886,-0.030930181965232,-0.033088568598032,-0.017449520528317,-0.075003407895565,-0.066219002008438,0.111904710531235,-0.143480479717255,0.181324243545532,-0.033223658800125,-0.175548180937767,0.011421100236476,-0.056053847074509,0.096174456179142,-0.053053922951222,-0.074925899505615,-0.11670146882534,-0.103453405201435,0.027520580217242,0.041089996695519,-0.017411977052689,0.022542905062437,-0.156127691268921,-0.349834769964218,-0.095308564603329,-0.051301490515471,-0.022945208474994,-0.106535270810127,-0.009085761383176,0.021789155900478,-0.116260468959808,0.005639102309942,-0.029614070430398,0.127310246229172,0.002845983253792,-0.047365482896566,0.169024512171745,0.005362201482058,-0.119215413928032,0.055902309715748,0.04489590972662,0.29328653216362,0.153021275997162,0.061256323009729,0.00245880917646,-0.041963767260313,0.08682245016098,-0.216259762644768,0.085624031722546,0.079247765243054,0.017355585470796,0.047301422804594,0.126645997166634,-0.085286736488342,0.009083635173738,0.060580212622881,-0.131402432918549,0.026414440944791,0.029095105826855,-0.014532384462655,-0.042116466909647,-0.06916269659996,0.1907589584589,0.120048552751541,-0.116383366286755,-0.070408202707768,0.111399002373219,-0.180759519338608,-0.040388483554125,-0.045203216373921,-0.064773455262184,-0.135989978909493,-0.281208693981171,0.097763665020466,0.412549823522568,0.204294472932816,-0.168928995728493,0.07511455565691,-0.049020767211914,-0.069383248686791,0.1147695556283,0.015928307548165,-0.110231310129166,0.026796327903867,-0.059451702982187,0.07505077123642,0.196391940116882,0.071851581335068,-0.043553072959185,0.199264198541641,0.00373337068595,0.030653124675155,0.044339340180159,0.017949037253857,-0.152978539466858,-0.017557380720973,-0.136968776583672,-0.001487131230533,0.105600036680698,-0.054990887641907,0.027614189311862,0.118440449237823,-0.192889839410782,0.184395924210548,-0.002457035938278,-0.013154081068933,0.071767561137676,0.145947605371475,-0.205794781446457,-0.04967425391078,0.159195959568024,-0.208480954170227,0.078711673617363,0.144970595836639,0.056998685002327,0.134461551904678,0.190307021141052,0.062741532921791,0.029253529384732,0.06920936703682,-0.174048185348511,-0.080037832260132,0.039433460682631,0.006129724439234,0.08686875551939,0.097845517098904
             ]
          }
        }
      }
    }
  },
  "size": 100
})
# print(res)

"""
for doc in res['hits']['hits']:
    print("%s) %s" %(doc['_id'], doc['_source']['name']))"""

print(res['hits']['hits'][0]['_source']['name'])
